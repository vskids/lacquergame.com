<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="initial-scale=1.0">
		
		<title>Basic Bootstrap Template</title>
		
		<!-- Bootstrap -->
		<link href="css/styles.css" rel="stylesheet" type="text/css" data-skrollr-stylesheet>
		
		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
	</head>
	<body>



<section id="sky-phase" class="line-height-rel">
	<div class="back fixed">
		<div class="back fill"></div>
		<div id="starfield1" class="back image"></div>
		<div id="starfield2" class="back image"></div>
		<div id="starfield3" class="back image"></div>
		<div id="starfield4" class="back image"></div>
	</div>
	
	<div class="container vh-100">
		<div class="monologue">Oh, there you are.  I missed you.</div>
	</div>
	<div class="container vh-50">
		<div class="monologue">
			You know what I've been thinking a lot about lately?<br>
			The stars.
		</div>
	</div>
	<div class="container vh-50">
		<div class="monologue">
			The constellations were named by the ancient Greeks…<br>
			and those stars are still there,<br>
			as bright as they always have been.
		</div>
	</div>
</section>
<section id="ambitions-phase" class="base-height-rel">
	<div class="back fill"></div>
	
	<div class="container vh-50">
		<div class="monologue">
			I want to leave my mark somehow, so no one ever forgets my dream:<br>
			To shine like a star, A dazzling light, Against a cold backdrop.
		</div>
	</div>
	<div class="container vh-50">
		<div class="monologue">
			my story:<br>
			Fulfilling my dreams of skating not just for myself but for everyone.
		</div>
	</div>
	<div class="container vh-50">
		<div class="monologue">
			my constellation:<br>
			My mark on this lake, my canvas, my piece of the world.
		</div>
	</div>
</section>
<section id="title-phase" class="screen-height-rel">
	<div class="back fill"></div>
	
	<div class="container vh-100">
		<div class="">Lacquer: From Dreams To Ice</div>
		<div class="">Leave your mark this winter.</div>
	</div>
</section>



		<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
		<script src="bower_components/jquery/dist/jquery.min.js"></script>
		<!-- Include all compiled plugins (below), or include individual files as needed -->
		<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
		<script src="bower_components/skrollr-stylesheets/dist/skrollr.stylesheets.min.js"></script>
		<script src="bower_components/skrollr/src/skrollr.js"></script>
		<!--[if lt IE 9]><script type="text/javascript" src="bower_components/skrollr-ie/dist/skrollr.ie.min.js"></script><![endif]-->
		<script>
var accelDecelSkrollrEasing = function (progress, domElement, propertyName, targetValue, currentValueGetter, newValueSetter, keyframeValues) {
	var currentValue = currentValueGetter();
	if (currentValue[2] == targetValue[2])
		return progress;
	
	if (domElement['___skrollr_accelDecel'] == undefined)
		domElement['___skrollr_accelDecel'] = {};
	
	var state = domElement.___skrollr_accelDecel[propertyName];
	if (state === null || state === undefined) {
		state = domElement.___skrollr_accelDecel[propertyName] = {
			velocity: 0.0,
			direction: 0,
			target: targetValue[2] //.slice(1)
		};
		
		setTimeout(function () {
			_step(state, currentValueGetter);
		}, 10);
	}
	else {
		state.target = targetValue[2]; //.slice(1)
	}
	
	var leftRightDelta = keyframeValues.right[2] - keyframeValues.left[2];
	var newValueLeftOffset = currentValue - keyframeValues.left[2];
	var newProgress = newValueLeftOffset / leftRightDelta;
	return newProgress;
	
	var state = domElement.___skrollr_accelDecel[propertyName];
	
	function _step(state) {
		if (state === null || state === undefined)
			return;
		
		var currentValue = currentValueGetter();
		
		var deltaValue = state.target - currentValue[2];
		if (Math.abs(deltaValue) < 1.0) {
			newValueSetter([targetValue[0], targetValue[1], state.target]);
			
			domElement.___skrollr_accelDecel[propertyName] = null;
			return;
		}
		
		var direction = (deltaValue > 0) ? 1 : -1;
		var accelAmount = (direction != state.direction) ? 0.5 : 2.0;
		var accelVelocity = (state.velocity + direction) * accelAmount;
		var decelVelocity = deltaValue * 0.5;
		var newVelocity = (Math.abs(accelVelocity) < Math.abs(decelVelocity)) ? accelVelocity : decelVelocity;
		
		var newValue = currentValue[2] + newVelocity;
		
		var currentValue_beforeSet = currentValueGetter();
		newValueSetter([targetValue[0], targetValue[1], newValue]);
		var currentValue_afterSet = currentValueGetter();
		
		console.log(
			'velocity: '+state.velocity+'->'+newVelocity+', ' +
			'delta: '+deltaValue+', ' +
			'dir: '+direction+', ' +
			'accel: '+accelVelocity+', ' +
			'decel: '+decelVelocity+', ' +
			'value: '+currentValue_beforeSet+'->'+currentValue_afterSet
		);
		
		state.velocity = newVelocity;
		
		setTimeout(function () {
			_step(state);
		}, 10);
	}
};

/// @source: http://stackoverflow.com/questions/10425287/convert-string-to-camelcase-with-regular-expression#10425344
function camelCase(input) { 
	return input.toLowerCase().replace(/-(.)/g, function(match, group1) {
		return group1.toUpperCase();
	});
}

function cacheIdElement(elementId) {
	var element = document.getElementById(elementId);
	if (element == null)
		throw "Could not find required element with id #"+elementId+".  Aborting cacheIdElement().";
	
	var idVarName = '$'+camelCase(elementId)+'Element';
	window[idVarName] = element;
}
cacheIdElement('sky-phase');
cacheIdElement('ambitions-phase');
cacheIdElement('title-phase');


Math.HalfPI = Math.PI * 0.5;

function easeInQuad(t) {
	return t * t;
}
function easeOutQuad(t) {
	return -(t * (t - 2));
}
function easeInOutQuad(t) {
	t *= 2;
	if (t < 1)
		return 0.5 * t * t;
	--t;
	return -0.5 * (t * (t - 2) - 1);
}
function easeInCubic(t) {
	return t * t * t;
}
function easeOutCubic(t) {
	t -= 1;
	return t * t * t + 1;
}
function easeInOutCubic(t) {
	t *= 2;
	if (t < 1)
		return 0.5 * t * t * t;
	t -= 2;
	return 0.5 * (t * t * t + 2);
}
function easeInQuart(t) {
	return t * t * t * t;
}
function easeOutQuart(t) {
	t -= 1;
	return -(t * t * t * t - 1);
}
function easeInOutQuart(t) {
	t *= 2;
	if (t < 1)
		return 0.5 * t * t * t * t;
	t -= 2;
	return -0.5 * (t * t * t * t - 2);
}
function easeInQuint(t) {
	return t * t * t * t * t;
}
function easeOutQuint(t) {
	t -= 1;
	return t * t * t * t * t + 1;
}
function easeInOutQuint(t) {
	t *= 2;
	if (t < 1)
		return 0.5 * t * t * t * t * t;
	t -= 2;
	return 0.5 * (t * t * t * t * t + 2);
}
function easeInSine(t) {
	return -(Math.cos(t * Math.HalfPI) + 1);
}
function easeOutSine(t) {
	return Math.sin(t * Math.HalfPI);
}
function easeInOutSine(t) {
	return -0.5 * (Math.cos(Math.PI * t) - 1);
}
function easeInExpo(t) {
	if (t == 0)
		return 0;
	return Math.pow(2, 10 * (t - 1));
}
function easeOutExpo(t) {
	if (t == 1)
		return 1;
	return (-Math.pow(2, -10 * t) + 1);
}
function easeInOutExpo(t) {
	if (t == 0)
		return 0;
	if (t == 1)
		return 1;
	t *= 2;
	if (t < 1)
		return 0.5 * Math.pow(2, 10 * (t - 1));
	--t;
	return 0.5 * (-Math.pow(2, -10 * t) + 2);
}
function easeInCirc(t) {
	return -(Math.sqrt(1 - t * t) - 1);
}
function easeOutCirc(t) {
	t -= 1;
	return Math.sqrt(1 - t * t);
}
function easeInOutCirc(t) {
	t *= 2;
	if (t < 1)
		return -0.5 * (Math.sqrt(1 - t * t) - 1);
	t -= 2;
	return 0.5 * (Math.sqrt(1 - t * t) + 1);
}

var $s = skrollr.init({
	mobileCheck: function () { return false; },
	edgeStrategy: 'ease',
	forceHeight: false,
	smoothScrolling: false,
	easing: {
		linearMidToEnd: function (p) {
			if (p <= 0.5)
				return 0.0;
			else
				return (p - 0.5) * 2;
		},
		linearStartToMid: function (p) {
			if (p < 0.5)
				return p * 2;
			else
				return 1.0;
			},
		accelDecel: accelDecelSkrollrEasing,
		inQuad: easeInQuad,
		outQuad: easeOutQuad,
		inOutQuad: easeInOutQuad,
		inCubic: easeInCubic,
		outCubic: easeOutCubic,
		inOutCubic: easeInOutCubic,
		inQuart: easeInQuart,
		outQuart: easeOutQuart,
		inOutQuart: easeInOutQuart,
		inQuint: easeInQuint,
		outQuint: easeOutQuint,
		inOutQuint: easeInOutQuint,
		inSine: easeInSine,
		outSine: easeOutSine,
		inOutSine: easeInOutSine,
		inExpo: easeInExpo,
		outExpo: easeOutExpo,
		inOutExpo: easeInOutExpo,
		inCirc: easeInCirc,
		outCirc: easeOutCirc,
		inOutCirc: easeInOutCirc,
	},
	constants: {
		sky_phase_start_before: function () {
			var box = $skyPhaseElement.getBoundingClientRect();
			var boxHeight = box.bottom - box.top; // for IE-compat
			return skrollr.get().relativeToAbsolute($skyPhaseElement, 'top', 'top') - (boxHeight * 0.20);
		},
		sky_phase_start: function () { return skrollr.get().relativeToAbsolute($skyPhaseElement, 'top', 'top'); },
		sky_phase_center: function () { return skrollr.get().relativeToAbsolute($skyPhaseElement, 'top', 'center'); },
		sky_phase_end: function () { return skrollr.get().relativeToAbsolute($skyPhaseElement, 'top', 'bottom'); },
		ambitions_phase_start: function () { return skrollr.get().relativeToAbsolute($ambitionsPhaseElement, 'bottom', 'top'); },
		ambitions_phase_center: function () { return skrollr.get().relativeToAbsolute($ambitionsPhaseElement, 'center', 'center'); },
		ambitions_phase_end: function () { return skrollr.get().relativeToAbsolute($ambitionsPhaseElement, 'top', 'bottom'); },
		title_phase_start: function () { return skrollr.get().relativeToAbsolute($titlePhaseElement, 'bottom', 'top'); },
		title_phase_center: function () { return skrollr.get().relativeToAbsolute($titlePhaseElement, 'center', 'center'); },
		title_phase_end: function () { return skrollr.get().relativeToAbsolute($titlePhaseElement, 'top', 'bottom'); },
	}
});
		</script>
		<script>
var $unscaleBackgrounds_closeEnoughDifference = 20;
function unscaleBackgrounds(jQElements, lastStateObject) {
	// according to: http://www.quirksmode.org/mobile/viewports2.html
	var layoutViewportWidth = document.documentElement.clientWidth;
	var visualViewportWidth = window.innerWidth;
	var screenWidth = screen.width;
	if (layoutViewportWidth == lastStateObject.layoutViewportWidth && visualViewportWidth == lastStateObject.visualViewportWidth) {
		return;
	} else {
		lastStateObject.layoutViewportWidth = layoutViewportWidth;
		lastStateObject.visualViewportWidth = visualViewportWidth;
	}
	
	var isCloseEnoguhToAssume1To1Scale = Math.abs(visualViewportWidth - layoutViewportWidth) < $unscaleBackgrounds_closeEnoughDifference;
	var viewportInverseZoom = isCloseEnoguhToAssume1To1Scale ? 1.0 : (visualViewportWidth / layoutViewportWidth);
	if (viewportInverseZoom == lastStateObject.viewportInverseZoom)
		return;
	else
		lastStateObject.viewportInverseZoom = viewportInverseZoom;
	
	jQElements.css({ zoom: viewportInverseZoom });
}

$(document).ready(function() {
	$lastState_unscaleSkyBackImages = {};
	var unscaleSkyBackImages = function () {
		unscaleBackgrounds($('#sky-phase > .back.image, #sky-phase > .back .image'), $lastState_unscaleSkyBackImages);
	};
	unscaleSkyBackImages();
	$(window).on('scroll resize', unscaleSkyBackImages);
});
		</script>
	</body>
</html>
